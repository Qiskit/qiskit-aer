<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Device backend noise model simulations" href="2_device_noise_simulation.html" /><link rel="prev" title="High-Performance Simulator Tutorials" href="index.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Simulators - Qiskit Aer 0.16.1</title>
      <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=3ee1c6c6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-sphinx-theme.css?v=fe84956c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/qiskit-ecosystem.css?v=745c5aa7" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=IBM+Plex+Sans:ital,wght@0,400;0,600;1,400;1,600&display=swap" rel="stylesheet">
<script src="../_static/js/web-components/top-nav-bar.js"></script></head>
  <body>
    
    <script>document.body.dataset.theme = "light";</script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <path d="M28,4H4A2,2,0,0,0,2,6V26a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V6A2,2,0,0,0,28,4ZM4,6H20V26H4ZM28,26H22V6h6Z"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32">
      <defs><style>.cls-1{fill:none;}</style></defs>
      <rect x="4" y="6" width="24" height="2"/>
      <rect x="4" y="24" width="24" height="2"/>
      <rect x="4" y="12" width="24" height="2"/>
      <rect x="4" y="18" width="24" height="2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg version="1.1" id="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
         viewBox="0 0 32 32" style="enable-background:new 0 0 32 32;" xml:space="preserve"><polygon points="22,16 12,26 10.6,24.6 19.2,16 10.6,7.4 12,6 " stroke="currentColor"/>
      <rect id="_x3C_Transparent_Rectangle_x3E_" fill="none" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-new-tab" viewBox="0 0 32 32">
    <svg id="icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
      <defs>
        <style>
          .cls-1 {
            fill: none;
          }
        </style>
      </defs>
      <path fill="#6929C4" d="M26,28H6a2.0027,2.0027,0,0,1-2-2V6A2.0027,2.0027,0,0,1,6,4H16V6H6V26H26V16h2V26A2.0027,2.0027,0,0,1,26,28Z"/>
      <polygon fill="#6929C4" points="20 2 20 4 26.586 4 18 12.586 19.414 14 28 5.414 28 12 30 12 30 2 20 2"/>
      <rect id="_Transparent_Rectangle_" data-name="&lt;Transparent Rectangle&gt;" class="cls-1" width="32" height="32"/>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Qiskit Aer 0.16.1</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><div class="sidebar-brand">
  <a href="https://www.qiskit.org/ecosystem">
    <div class="sidebar-logo-container">
      <img class="sidebar-logo" src="../_static/images/ecosystem-logo.svg" alt="Qiskit Ecosystem logo"/>
    </div>
  </a>
  
  <span class="sidebar-brand-text">Qiskit Aer 0.16.1</span>
</div><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../apidocs/aer.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_provider.html">Aer Provider (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Aer Provider (qiskit_aer)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.AerProvider.html">AerProvider</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.AerSimulator.html">AerSimulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.QasmSimulator.html">QasmSimulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.StatevectorSimulator.html">StatevectorSimulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.UnitarySimulator.html">UnitarySimulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.AerError.html">AerError</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_jobs.html">Aer Jobs (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.jobs</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Aer Jobs (qiskit_aer.jobs)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.jobs.AerJob.html">AerJob</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_library.html">Instruction Library (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.library</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Instruction Library (qiskit_aer.library)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetStatevector.html">SetStatevector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetDensityMatrix.html">SetDensityMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetStabilizer.html">SetStabilizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetSuperOp.html">SetSuperOp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetUnitary.html">SetUnitary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SetMatrixProductState.html">SetMatrixProductState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_statevector.html">set_statevector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_density_matrix.html">set_density_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_stabilizer.html">set_stabilizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_unitary.html">set_unitary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_superop.html">set_superop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.set_matrix_product_state.html">set_matrix_product_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveState.html">SaveState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveStatevector.html">SaveStatevector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveStatevectorDict.html">SaveStatevectorDict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveDensityMatrix.html">SaveDensityMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveMatrixProductState.html">SaveMatrixProductState</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveClifford.html">SaveClifford</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveStabilizer.html">SaveStabilizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveSuperOp.html">SaveSuperOp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveUnitary.html">SaveUnitary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveExpectationValue.html">SaveExpectationValue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveExpectationValueVariance.html">SaveExpectationValueVariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveProbabilities.html">SaveProbabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveProbabilitiesDict.html">SaveProbabilitiesDict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveAmplitudes.html">SaveAmplitudes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.SaveAmplitudesSquared.html">SaveAmplitudesSquared</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_amplitudes.html">save_amplitudes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_amplitudes_squared.html">save_amplitudes_squared</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_clifford.html">save_clifford</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_density_matrix.html">save_density_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_expectation_value.html">save_expectation_value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_expectation_value_variance.html">save_expectation_value_variance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_matrix_product_state.html">save_matrix_product_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_probabilities.html">save_probabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_probabilities_dict.html">save_probabilities_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_stabilizer.html">save_stabilizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_state.html">save_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_statevector.html">save_statevector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_statevector_dict.html">save_statevector_dict</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_superop.html">save_superop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.library.save_unitary.html">save_unitary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_noise.html">Noise Models (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.noise</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Noise Models (qiskit_aer.noise)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.NoiseModel.html">NoiseModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.QuantumError.html">QuantumError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.PauliLindbladError.html">PauliLindbladError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.ReadoutError.html">ReadoutError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.pauli_error.html">pauli_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.depolarizing_error.html">depolarizing_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.mixed_unitary_error.html">mixed_unitary_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.coherent_unitary_error.html">coherent_unitary_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.reset_error.html">reset_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.amplitude_damping_error.html">amplitude_damping_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.phase_damping_error.html">phase_damping_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.phase_amplitude_damping_error.html">phase_amplitude_damping_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.thermal_relaxation_error.html">thermal_relaxation_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.kraus_error.html">kraus_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.LocalNoisePass.html">LocalNoisePass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.RelaxationNoisePass.html">RelaxationNoisePass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.basic_device_readout_errors.html">basic_device_readout_errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.basic_device_gate_errors.html">basic_device_gate_errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.gate_param_values.html">gate_param_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.gate_error_values.html">gate_error_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.gate_length_values.html">gate_length_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.readout_error_values.html">readout_error_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.noise.device.thermal_relaxation_values.html">thermal_relaxation_values</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_primitives.html">Primitives (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.primitives</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Primitives (qiskit_aer.primitives)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.primitives.Sampler.html">Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.primitives.Estimator.html">Estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.primitives.SamplerV2.html">SamplerV2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.primitives.EstimatorV2.html">EstimatorV2</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_utils.html">Utilities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.utils</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Utilities (qiskit_aer.utils)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.insert_noise.html">insert_noise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.approximate_quantum_error.html">approximate_quantum_error</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.approximate_noise_model.html">approximate_noise_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.transform_noise_model.html">transform_noise_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.transpile_noise_model.html">transpile_noise_model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.utils.transpile_quantum_error.html">transpile_quantum_error</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../apidocs/aer_quantum_info.html">Aer Quantum Info (<code class="xref py py-mod docutils literal notranslate"><span class="pre">qiskit_aer.quantum_info</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Aer Quantum Info (qiskit_aer.quantum_info)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.quantum_info.AerStatevector.html">AerStatevector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stubs/qiskit_aer.quantum_info.AerDensityMatrix.html">AerDensityMatrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../apidocs/circuit.html">Additional circuit methods</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Simulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_device_noise_simulation.html">Device backend noise model simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_building_noise_models.html">Building Noise Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="4_custom_gate_noise.html">Applying noise to custom unitary gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_noise_transformation.html">Noise Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_extended_stabilizer_tutorial.html">The Extended Stabilizer Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_matrix_product_state_method.html">Matrix product state simulation method</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../howtos/index.html">How-Tos</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of How-Tos</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../howtos/parallel.html">Running with Threadpool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howtos/running_gpu.html">Running with multiple-GPUs and/or multiple nodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

</div></div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="Simulators">
<h1>Simulators<a class="headerlink" href="#Simulators" title="Permalink to this heading">#</a></h1>
<section id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this heading">#</a></h2>
<p>This notebook shows how to import the <em>Qiskit Aer</em> simulator backend and use it to run ideal (noise free).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Import Qiskit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">transpile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_aer</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerSimulator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qiskit.visualization</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_histogram</span><span class="p">,</span> <span class="n">plot_state_city</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qiskit.quantum_info</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">qi</span>
</pre></div>
</div>
</div>
</section>
<section id="The-AerSimulator">
<h2>The AerSimulator<a class="headerlink" href="#The-AerSimulator" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AerSimulator.available_devices()</span></code> : Return the available simulation devices.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AerSimulator.available_methods()</span></code> : Return the available simulation methods.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Simulating-a-Quantum-Circuit">
<h2>Simulating a Quantum Circuit<a class="headerlink" href="#Simulating-a-Quantum-Circuit" title="Permalink to this heading">#</a></h2>
<p>The basic operation runs a quantum circuit and returns a counts dictionary of measurement outcomes. Here we run a simple circuit that prepares a 2-qubit Bell-state <span class="math notranslate nohighlight">\(\left|\psi\right\rangle = \frac{1}{\sqrt{2}}\left(\left|0,0\right\rangle + \left|1,1 \right\rangle\right)\)</span> and measures both qubits.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create circuit</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">()</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get counts</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">plot_histogram</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Bell-State counts&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1_aersimulator_7_0.png" src="../_images/tutorials_1_aersimulator_7_0.png" />
</div>
</div>
<section id="Returning-measurement-outcomes-for-each-shot">
<h3>Returning measurement outcomes for each shot<a class="headerlink" href="#Returning-measurement-outcomes-for-each-shot" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Simulator</span></code> also supports returning a list of measurement outcomes for each individual shot. This is enabled by setting the keyword argument <code class="docutils literal notranslate"><span class="pre">memory=True</span></code> in the run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run and get memory</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">memory</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_memory</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;11&#39;, &#39;00&#39;, &#39;11&#39;, &#39;00&#39;, &#39;00&#39;, &#39;00&#39;, &#39;00&#39;, &#39;00&#39;, &#39;11&#39;, &#39;11&#39;]
</pre></div></div>
</div>
</section>
<section id="Aer-Simulator-Options">
<h3>Aer Simulator Options<a class="headerlink" href="#Aer-Simulator-Options" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AerSimulator</span></code> backend supports a variety of configurable options which can be updated using the set_options method. See the AerSimulator API documentation for additional details.</p>
</section>
<section id="Simulation-Method">
<h3>Simulation Method<a class="headerlink" href="#Simulation-Method" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AerSimulator</span></code> supports a variety of simulation methods, each of which supports a different set of instructions. The method can be set manually using <code class="docutils literal notranslate"><span class="pre">simulator(method=value)</span></code> option, or a simulator backend with a preconfigured method can be obtained directly from the <code class="docutils literal notranslate"><span class="pre">AerSimulator</span></code></p>
<p>When simulating ideal circuits, changing the method between the exact simulation methods <code class="docutils literal notranslate"><span class="pre">stabilizer</span></code>, <code class="docutils literal notranslate"><span class="pre">statevector</span></code>, <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> and <code class="docutils literal notranslate"><span class="pre">matrix_product_state</span></code> should not change the simulation result (other than usual variations from sampling probabilities for measurement outcomes)</p>
</section>
<section id="Simulation-Method-Option">
<h3>Simulation Method Option<a class="headerlink" href="#Simulation-Method-Option" title="Permalink to this heading">#</a></h3>
<p>The simulation method is set using the method kwarg. A list supported simulation methods can be returned using available_methods(), these are</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>: Default simulation method. Select the simulation method automatically based on the circuit and noise model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;statevector&quot;</span></code>: A dense statevector simulation that can sample measurement outcomes from ideal circuits with all measurements at end of the circuit. For noisy simulations each shot samples a randomly sampled noisy circuit from the noise model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;density_matrix&quot;</span></code>: A dense density matrix simulation that may sample measurement outcomes from noisy circuits with all measurements at end of the circuit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;stabilizer&quot;</span></code>: An efficient Clifford stabilizer state simulator that can simulate noisy Clifford circuits if all errors in the noise model are also Clifford errors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;extended_stabilizer&quot;</span></code>: An approximate simulated for Clifford + T circuits based on a state decomposition into ranked-stabilizer state. The number of terms grows with the number of non-Clifford (T) gates.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;matrix_product_state&quot;</span></code>: A tensor-network statevector simulator that uses a Matrix Product State (MPS) representation for the state. This can be done either with or without truncation of the MPS bond dimensions depending on the simulator options. The default behaviour is no truncation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;unitary&quot;</span></code>: A dense unitary matrix simulation of an ideal circuit. This simulates the unitary matrix of the circuit itself rather than the evolution of an initial quantum state. This method can only simulate gates, it does not support measurement, reset, or noise.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;superop&quot;</span></code>: A dense superoperator matrix simulation of an ideal or noisy circuit. This simulates the superoperator matrix of the circuit itself rather than the evolution of an initial quantum state. This method can simulate ideal and noisy gates, and reset, but does not support measurement.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Increase shots to reduce sampling variance</span>
<span class="n">shots</span> <span class="o">=</span> <span class="mi">10000</span>



<span class="c1"># Statevector simulation method</span>
<span class="n">sim_statevector</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;statevector&#39;</span><span class="p">)</span>
<span class="n">job_statevector</span> <span class="o">=</span> <span class="n">sim_statevector</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_statevector</span> <span class="o">=</span> <span class="n">job_statevector</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Stabilizer simulation method</span>
<span class="n">sim_stabilizer</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;stabilizer&#39;</span><span class="p">)</span>
<span class="n">job_stabilizer</span> <span class="o">=</span> <span class="n">sim_stabilizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_stabilizer</span> <span class="o">=</span> <span class="n">job_stabilizer</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="c1"># Extended Stabilizer method</span>
<span class="n">sim_extstabilizer</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;extended_stabilizer&#39;</span><span class="p">)</span>
<span class="n">job_extstabilizer</span> <span class="o">=</span> <span class="n">sim_extstabilizer</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_extstabilizer</span> <span class="o">=</span> <span class="n">job_extstabilizer</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Density Matrix simulation method</span>
<span class="n">sim_density</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;density_matrix&#39;</span><span class="p">)</span>
<span class="n">job_density</span> <span class="o">=</span> <span class="n">sim_density</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_density</span> <span class="o">=</span> <span class="n">job_density</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Matrix Product State simulation method</span>
<span class="n">sim_mps</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;matrix_product_state&#39;</span><span class="p">)</span>
<span class="n">job_mps</span> <span class="o">=</span> <span class="n">sim_mps</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_mps</span> <span class="o">=</span> <span class="n">job_mps</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="n">plot_histogram</span><span class="p">([</span> <span class="n">counts_statevector</span><span class="p">,</span><span class="n">counts_stabilizer</span> <span class="p">,</span><span class="n">counts_extstabilizer</span><span class="p">,</span> <span class="n">counts_density</span><span class="p">,</span> <span class="n">counts_mps</span><span class="p">],</span>
               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Counts for different simulation methods&#39;</span><span class="p">,</span>
               <span class="n">legend</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;statevector&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;density_matrix&#39;</span><span class="p">,</span><span class="s1">&#39;stabilizer&#39;</span><span class="p">,</span><span class="s1">&#39;extended_stabilizer&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_product_state&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1_aersimulator_13_0.png" src="../_images/tutorials_1_aersimulator_13_0.png" />
</div>
</div>
<section id="Automatic-Simulation-Method">
<h4>Automatic Simulation Method<a class="headerlink" href="#Automatic-Simulation-Method" title="Permalink to this heading">#</a></h4>
<p>The default simulation method is automatic which will automatically select a one of the other simulation methods for each circuit based on the instructions in those circuits. A fixed simulation method can be specified by by adding the method name when getting the backend, or by setting the method option on the backend.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># automatic</span>
<span class="n">sim_automatic</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
<span class="n">job_automatic</span> <span class="o">=</span> <span class="n">sim_automatic</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">)</span>
<span class="n">counts_automatic</span> <span class="o">=</span> <span class="n">job_automatic</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plot_histogram</span><span class="p">([</span><span class="n">counts_automatic</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Counts for automatic simulation method&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="p">[</span> <span class="s1">&#39;automatic&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1_aersimulator_15_0.png" src="../_images/tutorials_1_aersimulator_15_0.png" />
</div>
</div>
</section>
</section>
<section id="GPU-Simulation">
<h3>GPU Simulation<a class="headerlink" href="#GPU-Simulation" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">statevector</span></code>, <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> and <code class="docutils literal notranslate"><span class="pre">unitary</span></code> simulators support running on a NVidia GPUs. For these methods the simulation device can also be manually set to CPU or GPU using <code class="docutils literal notranslate"><span class="pre">simulator</span> <span class="pre">=</span> <span class="pre">AerSimmulator(method='statevector',device='GPU')</span></code> backend option.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_aer</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerError</span>

<span class="c1"># Initialize a GPU backend</span>
<span class="c1"># Note that the cloud instance for tutorials does not have a GPU</span>
<span class="c1"># so this will raise an exception.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">simulator_gpu</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;statevector&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">AerError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Installing-GPU-Support">
<h2>Installing GPU Support<a class="headerlink" href="#Installing-GPU-Support" title="Permalink to this heading">#</a></h2>
<p>In order to install and run the GPU supported simulators on Linux, you need CUDA 11.2 or newer previously installed. CUDA itself would require a set of specific GPU drivers. Please follow CUDA installation procedure in the NVIDIA <a class="reference external" href="https://www.nvidia.com/drivers">web</a>.</p>
<p>If you want to install our GPU supported simulators, you have to install this other package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">qiskit</span><span class="o">-</span><span class="n">aer</span><span class="o">-</span><span class="n">gpu</span>
</pre></div>
</div>
<p>The package above is for CUDA&amp;reg 12, so if your system has CUDA 11 installed, install separate package:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">qiskit</span><span class="o">-</span><span class="n">aer</span><span class="o">-</span><span class="n">gpu</span><span class="o">-</span><span class="n">cu11</span>
</pre></div>
</div>
<p>This will overwrite your current <code class="docutils literal notranslate"><span class="pre">qiskit-aer</span></code> package installation giving you the same functionality found in the canonical <code class="docutils literal notranslate"><span class="pre">qiskit-aer</span></code> package, plus the ability to run the GPU supported simulators: <code class="docutils literal notranslate"><span class="pre">statevector</span></code>, <code class="docutils literal notranslate"><span class="pre">density</span> <span class="pre">matrix</span></code>, and <code class="docutils literal notranslate"><span class="pre">unitary</span></code>.</p>
<p>Note: This package is only available on x86_64 Linux. For other platforms that have CUDA support, you will have to build from source. You can refer to the <a class="reference external" href="https://github.com/Qiskit/qiskit-aer/blob/main/CONTRIBUTING.md#building-with-gpu-support">contributing guide</a> for instructions on doing this.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">qiskit_aer</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerError</span>

<span class="c1"># Initialize a GPU backend</span>
<span class="c1"># Note that the cloud instance for tutorials does not have a GPU</span>
<span class="c1"># so this will raise an exception.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">simulator_gpu</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;tensor_network&#39;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;GPU&#39;</span><span class="p">)</span>

<span class="k">except</span> <span class="n">AerError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Simulation-Precision">
<h3>Simulation Precision<a class="headerlink" href="#Simulation-Precision" title="Permalink to this heading">#</a></h3>
<p>One of the available simulator options allows setting the float precision for the <code class="docutils literal notranslate"><span class="pre">statevector</span></code>, <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">unitary</span></code> and <code class="docutils literal notranslate"><span class="pre">superop</span></code> methods. This is done using the <code class="docutils literal notranslate"><span class="pre">set_precision=&quot;single&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">precision=&quot;double&quot;</span></code> (default) option:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;statevector&#39;</span><span class="p">)</span>
<span class="n">simulator</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="s1">&#39;single&#39;</span><span class="p">)</span>

<span class="c1"># Run and get counts</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;00&#39;: 505, &#39;11&#39;: 519}
</pre></div></div>
</div>
<p>Setting the simulation precision applies to both CPU and GPU simulation devices. Single precision will halve the required memory and may provide performance improvements on certain systems.</p>
</section>
</section>
<section id="Custom-Simulator-Instructions">
<h2>Custom Simulator Instructions<a class="headerlink" href="#Custom-Simulator-Instructions" title="Permalink to this heading">#</a></h2>
<section id="Saving-the-simulator-state">
<h3>Saving the simulator state<a class="headerlink" href="#Saving-the-simulator-state" title="Permalink to this heading">#</a></h3>
<p>The state of the simulator can be saved in a variety of formats using custom simulator instructions.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Circuit method</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Supported Methods</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_state</span></code></p></td>
<td><p>Save the simulator state in the native format for the simulation method</p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_statevector</span></code></p></td>
<td><p>Save the simulator state as a statevector</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;statevector&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;matrix_product_state&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;extended_stabilizer&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_stabilizer</span></code></p></td>
<td><p>Save the simulator state as a Clifford stabilizer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;stabilizer&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_density_matrix</span></code></p></td>
<td><p>Save the simulator state as a density matrix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;statevector&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;matrix_product_state&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;density_matrix&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_matrix_product_state</span></code></p></td>
<td><p>Save the simulator state as a a matrix product state tensor</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;matrix_product_state&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">save_unitary</span></code></p></td>
<td><p>Save the simulator state as unitary matrix of the run circuit</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;unitary&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">save_superop</span></code></p></td>
<td><p>Save the simulator state as superoperator matrix of the run circuit</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;superop&quot;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that these instructions are only supported by the Aer simulator and will result in an error if a circuit containing them is run on a non-simulator backend such as an IBM Quantum device.</p>
</section>
<section id="Saving-the-final-statevector">
<h3>Saving the final statevector<a class="headerlink" href="#Saving-the-final-statevector" title="Permalink to this heading">#</a></h3>
<p>To save the final statevector of the simulation we can append the circuit with the <code class="docutils literal notranslate"><span class="pre">save_statevector</span></code> instruction. Note that this instruction should be applied before any measurements if we do not want to save the collapsed post-measurement state</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct quantum circuit without measure</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_statevector</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;statevector&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get statevector</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">statevector</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="n">plot_state_city</span><span class="p">(</span><span class="n">statevector</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Bell state&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1_aersimulator_26_0.png" src="../_images/tutorials_1_aersimulator_26_0.png" />
</div>
</div>
</section>
<section id="Saving-the-circuit-unitary">
<h3>Saving the circuit unitary<a class="headerlink" href="#Saving-the-circuit-unitary" title="Permalink to this heading">#</a></h3>
<p>To save the unitary matrix for a <code class="docutils literal notranslate"><span class="pre">QuantumCircuit</span></code> we can append the circuit with the <code class="docutils literal notranslate"><span class="pre">save_unitary</span></code> instruction. Note that this circuit cannot contain any measurements or resets since these instructions are not supported on for the <code class="docutils literal notranslate"><span class="pre">&quot;unitary&quot;</span></code> simulation method</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct quantum circuit without measure</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_unitary</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;unitary&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get unitary</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">unitary</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_unitary</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit unitary:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">unitary</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit unitary:
 [[ 0.70711+0.j  0.70711-0.j  0.     +0.j  0.     +0.j]
 [ 0.     +0.j  0.     +0.j  0.70711+0.j -0.70711+0.j]
 [ 0.     +0.j  0.     +0.j  0.70711+0.j  0.70711-0.j]
 [ 0.70711+0.j -0.70711+0.j  0.     +0.j  0.     +0.j]]
</pre></div></div>
</div>
</section>
<section id="Saving-multiple-states">
<h3>Saving multiple states<a class="headerlink" href="#Saving-multiple-states" title="Permalink to this heading">#</a></h3>
<p>We can also apply save instructions at multiple locations in a circuit. Note that when doing this we must provide a unique label for each instruction to retrieve them from the results</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct quantum circuit without measure</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">save_statevector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;psi_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_statevector</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;psi_</span><span class="si">{</span><span class="n">steps</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span> <span class="s1">&#39;automatic&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get saved data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;psi_5&#39;: Statevector([-1.+0.00000000e+00j,  0.-5.55111512e-17j],
             dims=(2,)),
 &#39;psi_4&#39;: Statevector([-0.30901699+0.j        ,  0.        -0.95105652j],
             dims=(2,)),
 &#39;psi_3&#39;: Statevector([0.58778525+0.j        , 0.        -0.80901699j],
             dims=(2,)),
 &#39;psi_2&#39;: Statevector([0.95105652+0.j        , 0.        -0.30901699j],
             dims=(2,)),
 &#39;psi_1&#39;: Statevector([1.+0.j, 0.+0.j],
             dims=(2,)),
 &#39;psi_0&#39;: Statevector([1.+0.j, 0.+0.j],
             dims=(2,))}
</pre></div></div>
</div>
</section>
<section id="Setting-the-simulator-to-a-custom-state">
<h3>Setting the simulator to a custom state<a class="headerlink" href="#Setting-the-simulator-to-a-custom-state" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AerSimulator</span></code> allows setting a custom simulator state for several of its simulation methods using custom simulator instructions</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Circuit method</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Supported Methods</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">set_statevector</span></code></p></td>
<td><p>Set the simulator state to the specified statevector</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;statevector&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;density_matrix&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">set_stabilizer</span></code></p></td>
<td><p>Set the simulator state to the specified Clifford stabilizer</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;stabilizer&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">set_density_matrix</span></code></p></td>
<td><p>Set the simulator state to the specified density matrix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;density_matrix&quot;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">set_unitary</span></code></p></td>
<td><p>Set the simulator state to the specified unitary matrix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;unitary&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;superop&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">set_superop</span></code></p></td>
<td><p>Set the simulator state to the specified superoperator matrix</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&quot;automatic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;superop&quot;</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>These instructions must be applied to all qubits in a circuit, otherwise an exception will be raised.</p></li>
<li><p>The input state must also be a valid state (statevector, density matrix, unitary etc) otherwise an exception will be raised.</p></li>
<li><p>These instructions can be applied at any location in a circuit and will override the current state with the specified one. Any classical register values (e.g. from preceding measurements) will be unaffected</p></li>
<li><p>Set state instructions are only supported by the Aer simulator and will result in an error if a circuit containing them is run on a non-simulator backend such as an IBM Quantum device.</p></li>
</ul>
<section id="Setting-a-Custom-Statevector">
<h4>Setting a Custom Statevector<a class="headerlink" href="#Setting-a-Custom-Statevector" title="Permalink to this heading">#</a></h4>
<p>The set_statevector instruction can be used to set a custom Statevector state. The input statevector must be valid (<span class="math notranslate nohighlight">\(|\langle\psi|\psi\rangle|=1\)</span>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a random statevector</span>
<span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">qi</span><span class="o">.</span><span class="n">random_statevector</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">num_qubits</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set initial state to generated statevector</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">set_statevector</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_state</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;statevector&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get saved data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;statevector&#39;: Statevector([-0.49859823-0.41410205j,  0.12480824+0.46132192j,
               0.33634191+0.30214216j,  0.234309  +0.3036574j ],
             dims=(2, 2))}
</pre></div></div>
</div>
</section>
<section id="Using-the-initialize-instruction">
<h4>Using the initialize instruction<a class="headerlink" href="#Using-the-initialize-instruction" title="Permalink to this heading">#</a></h4>
<p>It is also possible to initialize the simulator to a custom statevector using the <code class="docutils literal notranslate"><span class="pre">initialize</span></code> instruction. Unlike the <code class="docutils literal notranslate"><span class="pre">set_statevector</span></code> instruction this instruction is also supported on real device backends by unrolling to reset and standard gate instructions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use initilize instruction to set initial state</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">psi</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">))</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_state</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span> <span class="s1">&#39;statevector&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get result data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;statevector&#39;: Statevector([-0.49859823-0.41410205j,  0.12480824+0.46132192j,
               0.33634191+0.30214216j,  0.234309  +0.3036574j ],
             dims=(2, 2))}
</pre></div></div>
</div>
</section>
<section id="Setting-a-custom-density-matrix">
<h4>Setting a custom density matrix<a class="headerlink" href="#Setting-a-custom-density-matrix" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">set_density_matrix</span></code> instruction can be used to set a custom <code class="docutils literal notranslate"><span class="pre">DensityMatrix</span></code> state. The input density matrix must be valid (<span class="math notranslate nohighlight">\(Tr[\rho]=1, \rho \ge 0\)</span>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">qi</span><span class="o">.</span><span class="n">random_density_matrix</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">num_qubits</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">set_density_matrix</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_state</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;density_matrix&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get saved data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;density_matrix&#39;: DensityMatrix([[ 0.2075308 +0.j        ,  0.13161422-0.01760848j,
                  0.0442826 +0.07742704j,  0.04852053-0.01303171j],
                [ 0.13161422+0.01760848j,  0.20106116+0.j        ,
                  0.02568549-0.03689812j,  0.0482903 -0.04367912j],
                [ 0.0442826 -0.07742704j,  0.02568549+0.03689812j,
                  0.39731492+0.j        , -0.01114025-0.13426423j],
                [ 0.04852053+0.01303171j,  0.0482903 +0.04367912j,
                 -0.01114025+0.13426423j,  0.19409312+0.j        ]],
               dims=(2, 2))}
</pre></div></div>
</div>
</section>
<section id="Setting-a-custom-stabilizer-state">
<h4>Setting a custom stabilizer state<a class="headerlink" href="#Setting-a-custom-stabilizer-state" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">set_stabilizer</span></code> instruction can be used to set a custom <code class="docutils literal notranslate"><span class="pre">Clifford</span></code> stabilizer state. The input stabilizer must be a valid <code class="docutils literal notranslate"><span class="pre">Clifford</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a random Clifford C</span>
<span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">stab</span> <span class="o">=</span> <span class="n">qi</span><span class="o">.</span><span class="n">random_clifford</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set initial state to stabilizer state C|0&gt;</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">set_stabilizer</span><span class="p">(</span><span class="n">stab</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_state</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span> <span class="s2">&quot;stabilizer&quot;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get saved data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;stabilizer&#39;: StabilizerState([&#39;+ZZ&#39;, &#39;-IZ&#39;])}
</pre></div></div>
</div>
</section>
<section id="Setting-a-custom-unitary">
<h4>Setting a custom unitary<a class="headerlink" href="#Setting-a-custom-unitary" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">set_unitary</span></code> instruction can be used to set a custom unitary <code class="docutils literal notranslate"><span class="pre">Operator</span></code> state. The input unitary matrix must be valid (<span class="math notranslate nohighlight">\(U^\dagger U=\mathbb{1}\)</span>)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a random unitary</span>
<span class="n">num_qubits</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">unitary</span> <span class="o">=</span> <span class="n">qi</span><span class="o">.</span><span class="n">random_unitary</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">num_qubits</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Set initial state to unitary</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">set_unitary</span><span class="p">(</span><span class="n">unitary</span><span class="p">)</span>
<span class="n">circ</span><span class="o">.</span><span class="n">save_state</span><span class="p">()</span>

<span class="c1"># Transpile for simulator</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">AerSimulator</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;unitary&#39;</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">simulator</span><span class="p">)</span>

<span class="c1"># Run and get saved data</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;unitary&#39;: Operator([[-0.44885724-0.26721573j,  0.10468034-0.00288681j,
             0.4631425 +0.15474915j, -0.11151309-0.68210936j],
           [-0.37279054-0.38484834j,  0.3820592 -0.49653433j,
             0.14132327-0.17428515j,  0.19643043+0.48111423j],
           [ 0.2889092 +0.58750499j,  0.39509694-0.22036424j,
             0.49498355+0.2388685j ,  0.25404989-0.00995706j],
           [ 0.01830684+0.10524311j,  0.62584001+0.01343146j,
            -0.52174025-0.37003296j,  0.12232823-0.41548904j]],
          input_dims=(2, 2), output_dims=(2, 2))}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">qiskit</span>
<span class="n">qiskit</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;1.0.1&#39;
</pre></div></div>
</div>
</section>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        <div class="related-pages">
          <a class="next-page" href="2_device_noise_simulation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Device backend noise model simulations</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">High-Performance Simulator Tutorials</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2017-2025, Qiskit Development Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 2025/03/04</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Simulators</a><ul>
<li><a class="reference internal" href="#Introduction">Introduction</a></li>
<li><a class="reference internal" href="#The-AerSimulator">The AerSimulator</a></li>
<li><a class="reference internal" href="#Simulating-a-Quantum-Circuit">Simulating a Quantum Circuit</a><ul>
<li><a class="reference internal" href="#Returning-measurement-outcomes-for-each-shot">Returning measurement outcomes for each shot</a></li>
<li><a class="reference internal" href="#Aer-Simulator-Options">Aer Simulator Options</a></li>
<li><a class="reference internal" href="#Simulation-Method">Simulation Method</a></li>
<li><a class="reference internal" href="#Simulation-Method-Option">Simulation Method Option</a><ul>
<li><a class="reference internal" href="#Automatic-Simulation-Method">Automatic Simulation Method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#GPU-Simulation">GPU Simulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Installing-GPU-Support">Installing GPU Support</a><ul>
<li><a class="reference internal" href="#Simulation-Precision">Simulation Precision</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Custom-Simulator-Instructions">Custom Simulator Instructions</a><ul>
<li><a class="reference internal" href="#Saving-the-simulator-state">Saving the simulator state</a></li>
<li><a class="reference internal" href="#Saving-the-final-statevector">Saving the final statevector</a></li>
<li><a class="reference internal" href="#Saving-the-circuit-unitary">Saving the circuit unitary</a></li>
<li><a class="reference internal" href="#Saving-multiple-states">Saving multiple states</a></li>
<li><a class="reference internal" href="#Setting-the-simulator-to-a-custom-state">Setting the simulator to a custom state</a><ul>
<li><a class="reference internal" href="#Setting-a-Custom-Statevector">Setting a Custom Statevector</a></li>
<li><a class="reference internal" href="#Using-the-initialize-instruction">Using the initialize instruction</a></li>
<li><a class="reference internal" href="#Setting-a-custom-density-matrix">Setting a custom density matrix</a></li>
<li><a class="reference internal" href="#Setting-a-custom-stabilizer-state">Setting a custom stabilizer state</a></li>
<li><a class="reference internal" href="#Setting-a-custom-unitary">Setting a custom unitary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=a1b5a9b9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/qiskit-sphinx-theme.js?v=4d77b8ca"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>